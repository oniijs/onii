(globalThis.webpackChunk_oniijs_onii=globalThis.webpackChunk_oniijs_onii||[]).push([[759],{6948:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>v});var s=i(7396),l=i.n(s),n=i(5458),o=i(7429),r=i(4863);class a extends r.EmbedBlot{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}}a.blotName="break",a.tagName="BR";const c=a;class h extends r.TextBlot{}class u extends r.InlineBlot{static compare(t,e){const i=u.order.indexOf(t),s=u.order.indexOf(e);return i>=0||s>=0?i-s:t===e?0:t<e?-1:1}formatAt(t,e,i,s){if(u.compare(this.statics.blotName,i)<0&&this.scroll.query(i,r.Scope.BLOT)){const l=this.isolate(t,e);s&&l.wrap(i,s)}else super.formatAt(t,e,i,s)}optimize(t){if(super.optimize(t),this.parent instanceof u&&u.compare(this.statics.blotName,this.parent.statics.blotName)>0){const t=this.parent.isolate(this.offset(),this.length());this.moveChildren(t),t.wrap(this)}}}u.allowedChildren=[u,c,r.EmbedBlot,h],u.order=["cursor","inline","link","underline","strike","italic","bold","script","code"];const d=u;class m extends d{static create(t){const e=super.create(t);return e.setAttribute("href",this.sanitize(t)),e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank"),e}static formats(t){return t.getAttribute("href")}static sanitize(t){return function(t,e){const i=document.createElement("a");i.href=t;const s=i.href.slice(0,i.href.indexOf(":"));return e.indexOf(s)>-1}(t,this.PROTOCOL_WHITELIST)?t:this.SANITIZED_URL}format(t,e){t===this.statics.blotName&&e?this.domNode.setAttribute("href",this.constructor.sanitize(e)):super.format(t,e)}}m.blotName="link",m.tagName="A",m.SANITIZED_URL="about:blank",m.PROTOCOL_WHITELIST=["http","https","mailto","tel"];var p=i(6945),f=i(6932);const b=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]];class k extends o.BaseTooltip{constructor(t,e){super(t,e),this.preview=this.root.querySelector("a.ql-preview")}listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",(t=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),t.preventDefault()})),this.root.querySelector("a.ql-remove").addEventListener("click",(t=>{if(null!=this.linkRange){const t=this.linkRange;this.restoreFocus(),this.quill.formatText(t,"link",!1,n.Z.sources.USER),delete this.linkRange}t.preventDefault(),this.hide()})),this.quill.on(n.Z.events.SELECTION_CHANGE,((t,e,i)=>{if(null!=t){if(0===t.length&&i===n.Z.sources.USER){const[e,i]=this.quill.scroll.descendant(m,t.index);if(null!=e){this.linkRange=new p.e(t.index-i,e.length());const s=m.formats(e.domNode);return this.preview.textContent=s,this.preview.setAttribute("href",s),this.show(),void this.position(this.quill.getBounds(this.linkRange))}}else delete this.linkRange;this.hide()}}))}show(){super.show(),this.root.removeAttribute("data-mode")}}k.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join("");class q extends o.default{constructor(t,e){null!=e.modules.toolbar&&null==e.modules.toolbar.container&&(e.modules.toolbar.container=b),super(t,e),this.quill.container.classList.add("ql-snow")}extendToolbar(t){t.container.classList.add("ql-snow"),this.buildButtons(t.container.querySelectorAll("button"),f.Z),this.buildPickers(t.container.querySelectorAll("select"),f.Z),this.tooltip=new k(this.quill,this.options.bounds),t.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},((e,i)=>{t.handlers.link.call(t,!i.format.link)}))}}q.DEFAULTS=l()(!0,{},o.default.DEFAULTS,{modules:{toolbar:{handlers:{link(t){if(t){const t=this.quill.getSelection();if(null==t||0===t.length)return;let e=this.quill.getText(t);/^\S+@\S+\.\S+$/.test(e)&&0!==e.indexOf("mailto:")&&(e=`mailto:${e}`);const{tooltip:i}=this.quill.theme;i.edit("link",e)}else this.quill.format("link",!1)}}}}});const v=q},1129:()=>{}}]);